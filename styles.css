:root{font-size:14px;}
*{box-sizing:border-box;}
body{margin:0;background:#0d1117;color:#eee;font-family:system-ui,-apple-system,sans-serif;overflow-x:hidden;height:100dvh;}
#app{width:460px;max-width:100%;margin:0 auto;background:#0d1117;height:100dvh;display:flex;flex-direction:column;}

/* Topbar: Evenly balanced with center alignment */
.topbar{background:linear-gradient(to bottom, #1a1f2e, #0f172a);padding:10px;display:grid;grid-template-columns:1fr auto 1fr;gap:12px;justify-items:center;align-items:center;position:sticky;top:0;z-index:20;box-shadow:0 2px 10px #0008;}
#toggles{grid-column:2;display:flex;gap:4px;align-items:center;font-size:0.75rem;justify-content:center;}
.toggle-group{flex-shrink:0;}
.toggle-item{display:flex;align-items:center;gap:2px;padding:2px 4px;border-radius:4px;background:rgba(51,51,51,0.8);transition:all .2s;cursor:pointer;}
.toggle-item:hover{background:rgba(68,68,68,0.9);}
.toggle-item input{margin:0 2px 0 0;}
.toggle-select{padding:2px 4px;font-size:0.75rem;border:1px solid #666;border-radius:4px;background:#333;color:#eee;}
.btn{padding:8px 16px;border-radius:12px;font-weight:bold;cursor:pointer;text-align:center;flex:1;max-width:120px;}
.next-hand{background:#22c55e;color:#fff;}
.shuffle{background:#dc2626;color:#fff;}
.btn:active{transform:scale(0.96);}

.rank-grid{padding:10px;display:grid;grid-template-columns:repeat(7,1fr);gap:6px;background:#0f172a;}
.suit-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:6px;padding:5px;background:#0f172a;}
.card-btn{width:100%;aspect-ratio:1;padding:4px;border-radius:12px;background:#1d4ed8;color:#fff;font-weight:bold;font-size:1.1rem;border:2px solid #3b82f6;transition:all .1s;}
.suit-btn{aspect-ratio:2;background:#333 !important;border-color:#666 !important;font-size:1.8rem;}
.suit-btn.hearts,.suit-btn.diamonds{background:#dc2626 !important;border-color:#dc2626 !important;color:#fff;}
.card-btn:active{transform:scale(0.94);background:#2563eb;}

.table-container{flex:1;overflow:hidden;position:relative;}
.table{flex:1;display:flex;gap:0;overflow-x:auto;padding-top:5px;height:100%}
.column{flex:1;min-width:56px;display:flex;flex-direction:column;gap:0;position:relative;}

.seat-header{height:56px;display:flex;align-items:center;justify-content:center;position:sticky;top:0;z-index:10;background:#161b22;}
.seat-round{width:50px;height:50px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:bold;font-size:0.9rem;box-shadow:0 4px 12px #0008;}
.seat-round.dealer{background:#991b1b;color:#fca5a5;}
.seat-round.player{background:#1e40af;color:#93c5fd;}
.seat-round.your-seat{box-shadow:0 0 0 4px #22c55e, 0 0 20px #22c55e88;background:#166534;color:#fff;}
.seat-round.active{box-shadow:0 0 0 4px #00ff88;}

.hand{flex:1;overflow:hidden;display:flex;flex-direction:column;gap:-22px;padding:0px 4px 20px;background:#0d1117;}
.mini{width:35px;height:46px;border-radius:8px;margin:0 auto -25px auto;flex-shrink:0;
  box-shadow:0 4px 12px #0008,inset 0 0 20px rgba(255,255,255,0.1);background:linear-gradient(135deg,#fff,#f0f0f0);border:2px solid #333;position:relative;}
.mini .corner{position:absolute;font-size:0.83rem;font-weight:bold;}
.mini .top-left{top:2px;left:3px;}
.mini .bottom-right{bottom:2px;right:3px;transform:rotate(180deg);}
.mini .suit{position:absolute;font-size:0.85rem;font-weight:bold;}
.mini .top-right{top:0px;right:2px;}
.mini .bottom-left{bottom:0px;left:2px;transform:rotate(180deg);}
.mini[data-suit="hearts"],.mini[data-suit="diamonds"]{color:#dc2626;}
.mini[data-suit="spades"],.mini[data-suit="clubs"]{color:#000000;}

.split-container{display:flex;gap:2px;justify-content:center;margin-top:10px;height:100%;}
.split-hand{width:48%;display:flex;flex-direction:column;gap:-18px;align-items:center;border:2px solid transparent;transition:all .2s;}
.split-hand.active{border-color:#22c55e;box-shadow:0 0 15px #22c55e44;}
.split-hand:last-of-type{margin-left: -11px;}
.split-label{font-size:0.75rem;color:#aaa;margin-bottom:4px;}
.split-btn{background:#ea580c;color:#fff;padding:6px 10px;border-radius:8px;font-size:0.75rem;margin-top:8px;cursor:pointer;display:none;}
.split-btn:active{transform:scale(0.95);}

#insuranceBox{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#dc2626;color:#fff;padding:15px;border-radius:12px;display:none;flex-direction:column;gap:8px;font-weight:bold;text-align:center;box-shadow:0 4px 20px #dc262688;font-size:1rem;z-index:100;max-width:90vw;width:300px;}
#insuranceBox::before{content:'';position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.5);z-index:-1;}
.ins-btns{display:flex;gap:10px;justify-content:center;}
.ins-btns button{padding:8px 16px;border-radius:10px;font-weight:bold;background:#333;color:#fff;flex:1;}

#advice{background:#fff;color:#000;padding:18px;margin:8px;border-radius:12px;font-size:2.1rem;font-weight:bold;text-align:center;border:5px solid #ffd43f;transition:all .3s ease;} /* Added transition */
.wong-enter{background:#166534 !important;color:#fff !important;border-color:#22c55e !important;box-shadow:0 0 25px #22c55e88 !important;}
.wong-exit{background:#991b1b !important;color:#fff !important;border-color:#dc2626 !important;box-shadow:0 0 25px #dc262688 !important;}
.wong-neutral{background:#fff !important;color:#000 !important;border-color:#ffd43f !important;box-shadow:none !important;}
.adv-double{color:#e11d48;}.adv-hit{color:#17BE70;}.adv-stand{color:#dc2626;}.adv-split{color:#2299F9;}.adv-surrender{color:#c2410c;}

/* InfoBar: Balanced grid with symmetric sidebets */
#infoBar{background:linear-gradient(to bottom, #1e293b, #161b22);padding:12px;margin:8px;border-radius:10px;font-size:0.85rem;display:grid;grid-template-rows:auto auto auto;gap:8px;}
.info-top{display:flex;justify-content:space-evenly;align-items:center;text-align:center;flex-wrap:wrap;}
#ra{color:#22c55e;} #ra.negative{color:#ef4444;}
.counts{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;justify-items:center;}
.sidebets-inline{display:flex;justify-content:space-evenly;font-size:0.8rem;flex-wrap:wrap;}
.sidebets-inline span{display:inline-flex;align-items:center;gap:4px;margin:0 8px;}

#masePrinciples{display:none;background:linear-gradient(to bottom, #1a1f2e, #0f172a);padding:10px;margin:8px;border-radius:10px;font-size:0.75rem;max-height:120px;overflow-y:auto;}
.principle{list-style:none;margin:2px 0;}

/* Bottom: Symmetric grid with uniform heights */
/* Updated Bottom and Charts CSS for Full Space Usage */
.bottom{background:#161b22;padding:12px;display:flex;gap:12px;align-items:stretch;font-size:0.8rem;min-height:170px;} /* Changed to flex for better filling */
.betRamp{display:flex;flex-direction:column;gap:6px;background:linear-gradient(to bottom, #1e293b, #161b22);padding:10px;border-radius:10px;text-align:center;overflow:hidden;box-shadow:inset 0 1px 4px #0004;flex:2;} /* flex:2 for betRamp */
.charts-grid{display:flex;flex:1;align-items:stretch;border-radius:10px;background:#0d1117;box-shadow:0 2px 8px #0006;overflow:hidden;} /* flex:1, full height, background/shadow for consistency */
#combinedChart{width:100%;height:100%;flex:1;} /* Full size */

.bet-header{display:flex;justify-content:space-between;align-items:center;font-weight:bold;padding:4px 0;flex-wrap:wrap;gap:4px;}
.bet-inputs { display: flex; flex-direction: column; column-gap: 6px; align-items: center; font-size: 0.75rem; max-height: 140px; overflow-y: auto; padding: 4px; }
.betting-inputs, .multiplier-inputs { display: flex; gap: 2px; justify-content: center; flex-wrap: wrap; }
.multiplier-inputs { overflow:hidden; max-height: 0; }
.toggle-checkbox { display: none; } /* Hide the checkbox */
.toggle-label { 
  cursor: pointer; 
  user-select: none; 
  color: #94a3b8; 
  font-size: 0.7rem; 
  margin: 4px 0; 
  display: block; 
  text-align: center;
}
.toggle-label::after { content: " ▼"; } /* Default arrow */
.toggle-checkbox:checked ~ .toggle-label::after { content: " ▲"; } /* Flipped arrow when checked */
.toggle-checkbox:checked ~ .sidebet-inputs { 
  max-height: 120px; /* Expanded */
}
.toggle-checkbox:checked ~ .multiplier-inputs { 
  max-height: 80px; /* Expanded */
  row-gap: 4px;
}
.bet-inputs:has(.toggle-checkbox:checked) {
  row-gap: 4px;
}
.sidebet-inputs { 
  display: flex; 
  gap: 2px; 
  justify-content: center; 
  flex-wrap: wrap; 
  max-height: 0; 
  overflow: hidden; 
  transition: max-height 0.3s ease;
}
.sidebet-inputs input { font-size: 0.65rem; width: 45px; }
.main{font-size:2rem;color:#22c55e;}
#heatLevel{font-size:0.7rem;}
.ramp-note{font-size:0.7rem;color:#94a3b8;margin-top:4px;line-height:1.2;text-align:center;}

.hand-total{font-size:0.8rem;text-align:center;margin-top:5px;}

/* Media Queries: Enhanced balance for small screens */
@media (max-width: 400px) {
  :root{font-size:13px;}
  body{overflow-x:hidden;}
  .topbar{grid-template-columns:1fr;padding:8px;gap:8px;}
  #toggles{grid-column:1 / -1;justify-content:center;flex-wrap:wrap;}
  .toggle-group{gap:6px;}
  .btn{max-width:none;flex:1;}
  #infoBar{grid-template-columns:1fr;gap:6px;font-size:0.8rem;padding:8px;}
  .info-top{flex-direction:column;gap:4px;}
  .sidebets-inline{flex-direction:column;align-items:center;gap:4px;}
  .counts{grid-template-columns:1fr;gap:4px;}
  .bottom{grid-template-columns:1fr;grid-template-rows:auto auto;height:auto;padding:8px;gap:8px;}
  .betRamp{padding:8px;gap:4px;}
  .charts-grid{grid-template-columns:1fr;height:auto;gap:6px;}
  #combinedChart{height:60px;}
  .bet-header{flex-direction:column;align-items:center;gap:4px;}
  .main{font-size:1.6rem;}
  .ramp-note{font-size:0.65rem;}
  .bet-inputs{flex-wrap:wrap;gap:1px;justify-content:center;max-height:100px;}
  .sidebet-inputs{flex-direction:column;gap:1px;}
  .betting-inputs, .multiplier-inputs {gap:1px;}
  .rank-grid{grid-template-columns:repeat(7,minmax(30px,1fr));gap:4px;padding:8px;}
  .suit-grid{grid-template-columns:repeat(4,minmax(40px,1fr));gap:4px;padding:4px;}
  .card-btn{font-size:1rem;}
  .suit-btn{font-size:1.5rem;}
  .column{min-width:48px;}
  .seat-round{width:40px;height:40px;font-size:0.8rem;}
  .mini{width:28px;height:40px;margin:0 auto -20px auto;}
  .mini .corner{font-size:0.7rem;}
  .mini .suit{font-size:0.6rem;}
}
@media (max-width: 360px) {
  .sidebets-inline span{font-size:0.75rem;gap:2px;margin:0 4px;}
  .info-top{font-size:0.8rem;}
  .bet-inputs input{width:50px;font-size:0.7rem;}
  .sidebet-inputs input{width:40px;}
  #insuranceBox{width:280px;font-size:0.9rem;padding:12px;}
  .ins-btns{gap:8px;}
  .ins-btns button{padding:6px 12px;}
}
.seat-round.disabled{background:#666 !important;color:#aaa !important;box-shadow:0 2px 8px #0008 !important;}